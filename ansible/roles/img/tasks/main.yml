---
- name: Install packages
  apt:
    name:
      - unzip
      - parted
      - rsync
    install_recommends: yes
  tags:
    - img

- name: create pib cache dir
  file:
    path: "{{ cache_dir }}"
    state: directory

- name: Download pi sd card img file
  get_url:
    url: "{{ img_host }}/{{ img_path }}/{{ zip_name }}"
    dest: "{{ cache_dir }}"

- name: extract files from raspios.img.xz
  script: files/img2files.sh
  # args:
  #  creates: "{{ nfs_root }}"

- name: install scripts to manage pi states
  copy:
    src: files/files
    dest: /root


