---
- name: apt update/upgrade
  apt:
    # name: "*"
    upgrade: true
    state: latest
    update_cache: true
    cache_valid_time: 86400

- name: install gst packages
  apt:
    name:
      - gstreamer1.0-tools
      - gstreamer1.0-plugins-base
      - gstreamer1.0-plugins-good
      - gstreamer1.0-plugins-bad
      - gstreamer1.0-plugins-ugly
      - gstreamer1.0-plugins-base-apps
      - libcamera0
      - jq
      - rpicam-apps-lite
  tags:
    - streaming

- name: cam script
  copy:
    src: files/gst-libcam.sh
    dest: /usr/local/bin/gst-libcam.sh
    mode: u+x
  tags:
    cam

- name: systemd cam.service
  copy:
    src: files/cam.service
    dest: /etc/systemd/system/cam.service
  notify: reload-systemd
  tags:
    cam

- name: enable cam.service
  systemd:
    name: cam.service
    enabled: yes
  tags:
    cam
